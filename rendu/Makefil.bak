# **************************************************************************** #
#                                                                              #
#                                                         :::      ::::::::    #
#    Makefile                                           :+:      :+:    :+:    #
#                                                     +:+ +:+         +:+      #
#    By: bduron <marvin@42.fr>                      +#+  +:+       +#+         #
#                                                 +#+#+#+#+#+   +#+            #
#    Created: 2017/02/07 13:02:54 by bduron            #+#    #+#              #
#    Updated: 2017/02/07 13:13:03 by bduron           ###   ########.fr        #
#                                                                              #
# **************************************************************************** #

CHECKER= checker
PS= push_swap

CC= gcc
CFLAGS= -Wall -Wextra -Werror 
DEBUG= -g
LIBFT= -Llibft -lft 

MKDIR= mkdir -p
RM= rm -rf

SRC_DIR= srcs/
INC_DIR= includes/
OBJ_DIR= objs/

SHARED_SRC_BASE= 	shared/command_launcher.c \
					shared/error_handling.c \
					shared/sort_commands.c \
					shared/stack_management.c shared/stack_print.c




PS_SRC_BASE= 		push_swap/algo_inits.c \
					push_swap/algo_quartile.c \
					push_swap/algo_small.c \
					push_swap/algo_utils.c \
					push_swap/push_swap.c \
					push_swap/quicksort.c \
					push_swap/stack_state.c

CHECKER_PATH_BASE=	checker/checker.c \
					checker/checker_display.c checker/checker_parsing	

SHARED_SRC= $(addprefix $(SRC_DIR), $(SHARED_SRC_BASE))
PS_SRC= $(addprefix $(SRC_DIR), $(PS_SRC_BASE))
CHECKER_SRC= $(addprefix $(SRC_DIR), $(CHECKER_PATH_BASE))

SHARED_OBJ= $(addprefix $(OBJ_DIR), $(SHARED_SRC_BASE:.c=.o))
PS_OBJ= $(addprefix $(OBJ_DIR), $(PS_SRC_BASE:.c=.o))
CHECKER_OBJ= $(addprefix $(OBJ_DIR), $(CHECKER_SRC_BASE:.c=.o))


all: libft obj_mkdir $(CHECKER) $(PS)

libft:
	make -C libft
	echo "Compiling Libft"

obj_mkdir:
	$(MKDIR) $(OBJ_DIR)
	$(MKDIR) $(OBJ_DIR)/shared
	$(MKDIR) $(OBJ_DIR)/push_swap
	$(MKDIR) $(OBJ_DIR)/checker


$(CHECKER): $(CHECKER_OBJ) $(SHARED_OBJ) 
	$(CC) -o $@ $(CFLAGS) $^ -I $(INC_DIR) $(LIBFT) 

$(PS): $(PS_OBJ) $(SHARED_OBJ) 
	$(CC) -o $@ $(CFLAGS) $^ -I $(INC_DIR) $(LIBFT) 


$(SHARED_OBJ): $(SHARED_SRC)
	$(CC) -c $< $(CFALGS) -I $(INC_DIR) 

$(PS_OBJ): $(PS_SRC)
	$(CC) -c $< $(CFALGS) -I $(INC_DIR) 

$(CHECKER_OBJ): $(CHECKER_SRC)
	$(CC) -c $< $(CFALGS) -I $(INC_DIR) 	



clean:
	#	@rm -f $(OBJ)

fclean: clean
	@rm -rf $(CHECKER) $(PS)
	@make fclean -C libft
	@echo "Cleaning..."	

re: fclean all

.PHONY: clean fclean re lib 
